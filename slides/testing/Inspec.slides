Inspec
Fabrizio Sabatini || Last update: xx Nov 2018

* Inspec

- [[https://www.inspec.io/]]
- [[https://www.inspec.io/docs/reference/platforms/]]

Install inspect with:

  gem install inspec

* The install iggy

- [[https://github.com/inspec/inspec-iggy]]

  inspec plugin install inspec-iggy

* Create a test dir

    inspec terraform generate

* Generate the tests

  describe aws_security_group('sg-xxx') do
    it { should allow_in ipv4_range: '1.0.0.0/32' }
  end

  control 'ssss' do
    aws_security_groups.group_ids.each do |group_id|
      describe aws_security_group(group_id) do
        it { should_not allow_in(port: 22, ipv4_range: '0.0.0.0/0') }
      end
    end
  end
